apiVersion: v1
data:
  config.yaml: |
    receivers:
      filelog/k8s:
        include:
          - ${env:K8S_LOG_PATH}
        start_at: beginning
        retry_on_failure:
          enabled: true
        include_file_path: true
        include_file_name: false
        operators:
          - type: container
    exporters:
      debug:
        verbosity: detailed
    service:
      pipelines:
        logs:
          receivers:
            - filelog/k8s
          exporters:
            - debug
immutable: true
kind: ConfigMap
metadata:
  annotations:
    kubepose.volume.hmac-key: kubepose.volume.v1
    testing: abc
  creationTimestamp: null
  name: collector-0b038390

---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  annotations:
    kubepose.service.serviceAccountName: otelcontribcol
    testing: abc
  creationTimestamp: null
  name: collector
spec:
  selector:
    matchLabels:
      kubepose.service: collector
  template:
    metadata:
      annotations:
        kubepose.service.serviceAccountName: otelcontribcol
        testing: abc
      creationTimestamp: null
      labels:
        kubepose.service: collector
    spec:
      containers:
      - env:
        - name: K8S_LOG_PATH
          value: /var/log/pods/default_*/*/*.log
        - name: K8S_NAMESPACE
          value: default
        image: otel/opentelemetry-collector-contrib:0.116.1
        imagePullPolicy: IfNotPresent
        name: collector
        ports:
        - containerPort: 4317
          protocol: TCP
        - containerPort: 4318
          protocol: TCP
        resources: {}
        volumeMounts:
        - mountPath: /etc/otelcol-contrib/config.yaml
          name: collector-0b038390
          readOnly: true
          subPath: config.yaml
        - mountPath: /var/log/pods
          name: pod-logs
          readOnly: true
      restartPolicy: Always
      serviceAccountName: otelcontribcol
      volumes:
      - configMap:
          name: collector-0b038390
        name: collector-0b038390
      - hostPath:
          path: /var/log/pods
        name: pod-logs
  updateStrategy: {}
status:
  currentNumberScheduled: 0
  desiredNumberScheduled: 0
  numberMisscheduled: 0
  numberReady: 0

---
apiVersion: v1
kind: Service
metadata:
  annotations:
    kubepose.service.serviceAccountName: otelcontribcol
  creationTimestamp: null
  name: collector
spec:
  ports:
  - name: "4317"
    port: 4317
    protocol: TCP
    targetPort: 4317
  - name: "4318"
    port: 4318
    protocol: TCP
    targetPort: 4318
  selector:
    kubepose.service: collector
status:
  loadBalancer: {}
