services:
  redis-leader:
    container_name: redis-leader
    image: redis
    ports:
      - "6379"
    deploy:
      resources:
        limits:
          cpus: 2
          memory: 2000m
        reservations:
          cpus: 1
          memory: 1g

  redis-replica:
    container_name: redis-replica
    image: redis
    ports:
      - "6379"
    command: redis-server --replicaof redis-leader 6379
    annotations:
      kubepose.service.ignore: "true"

  web:
    container_name: web
    image: nginx
    build: ./web
    ports:
      - "8080:8080"
